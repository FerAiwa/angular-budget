(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"ct+p":function(t,e,s){"use strict";s.r(e),s.d(e,"HomeModule",(function(){return g}));var n=s("ofXK"),b=s("tyNb"),o=s("2FCU"),c=s("fXoL"),i=s("tk/3");function a(t,e){1&t&&(c.Kb(0,"sup"),c.ec(1,"*"),c.Jb())}function r(t,e){1&t&&(c.Kb(0,"sup"),c.ec(1,"*"),c.Jb())}const p=function(t){return["projects",t]};function d(t,e){if(1&t&&(c.Kb(0,"aside"),c.Kb(1,"h3"),c.Kb(2,"a",3),c.ec(3),c.Jb(),c.Jb(),c.Kb(4,"p"),c.Kb(5,"i"),c.ec(6),c.Tb(7,"date"),c.Tb(8,"date"),c.Jb(),c.Jb(),c.Kb(9,"p"),c.ec(10,"Presupuesto: "),c.Kb(11,"b"),c.ec(12),c.Tb(13,"number"),c.Jb(),c.Jb(),c.Kb(14,"p"),c.ec(15,"Gastos: "),c.Kb(16,"b"),c.ec(17),c.Tb(18,"number"),c.Jb(),c.Jb(),c.Kb(19,"p"),c.ec(20,"Ingresos: "),c.Kb(21,"b"),c.ec(22),c.Tb(23,"number"),c.Jb(),c.Jb(),c.Kb(24,"p"),c.ec(25,"Beneficio: "),c.Kb(26,"b"),c.ec(27),c.Tb(28,"number"),c.Jb(),c.cc(29,a,2,0,"sup",4),c.Jb(),c.Kb(30,"p"),c.ec(31," Saldo: "),c.Kb(32,"b"),c.ec(33),c.Tb(34,"number"),c.Jb(),c.cc(35,r,2,0,"sup",4),c.Jb(),c.Jb()),2&t){const t=e.$implicit;c.xb(2),c.Wb("routerLink",c.Xb(27,p,t.id)),c.xb(1),c.fc(t.title),c.xb(3),c.hc(" ",c.Vb(7,11,t.start,"dd/MM/yyyy")," - ",c.Vb(8,14,t.end,"dd/MM/yyyy")," "),c.xb(6),c.gc("",c.Ub(13,17,t.budget)," \u20ac"),c.xb(5),c.gc(" ",c.Ub(18,19,t.totalExpenses)," \u20ac"),c.xb(5),c.gc(" ",c.Ub(23,21,t.totalIncomes)," \u20ac"),c.xb(5),c.gc(" ",c.Ub(28,23,t.profit)," \u20ac"),c.xb(2),c.Wb("ngIf",t.profit<0),c.xb(4),c.gc(" ",c.Ub(34,25,t.balance)," \u20ac"),c.xb(2),c.Wb("ngIf",t.balance<0)}}function u(t,e){if(1&t&&(c.Kb(0,"section"),c.Kb(1,"header"),c.Kb(2,"h2"),c.ec(3," Estado general de mis proyectos y tareas "),c.Jb(),c.Jb(),c.cc(4,d,36,29,"aside",2),c.Kb(5,"aside"),c.Kb(6,"h3"),c.ec(7,"Tareas"),c.Jb(),c.Kb(8,"p"),c.ec(9,"Completadas: "),c.Kb(10,"mark"),c.Kb(11,"b"),c.ec(12),c.Tb(13,"number"),c.Jb(),c.Jb(),c.Jb(),c.Kb(14,"p"),c.ec(15,"Pendientes: "),c.Kb(16,"b"),c.ec(17),c.Tb(18,"number"),c.Jb(),c.Kb(19,"sup"),c.ec(20,"!"),c.Jb(),c.Jb(),c.Jb(),c.Jb()),2&t){const t=c.Sb();c.xb(4),c.Wb("ngForOf",t.projectViews),c.xb(8),c.fc(c.Ub(13,3,t.tasksViews.total-t.tasksViews.pending)),c.xb(5),c.gc(" ",c.Ub(18,5,t.tasksViews.pending)," ")}}function l(t,e){1&t&&(c.Kb(0,"section"),c.Kb(1,"blockquote"),c.ec(2,"Esperando datos..."),c.Jb(),c.Jb())}const h=[{path:"",component:(()=>{class t{constructor(t){this.httpClient=t,this.projectViews=[],this.loaded=!1,this.rootUrl="https://api-base.herokuapp.com/api/pub",this.onProjectsLoaded={next:t=>{this.projects=t,this.httpClient.get(this.rootUrl+"/transactions").subscribe(this.onTransactionsLoaded)}},this.onTransactionsLoaded={next:t=>{this.transactions=t,this.httpClient.get(this.rootUrl+"/tasks").subscribe(this.onTasksLoaded)}},this.onTasksLoaded={next:t=>{this.tasks=t,this.setDataViews()}}}ngOnInit(){this.loadData()}loadData(){this.httpClient.get(this.rootUrl+"/projects").subscribe(this.onProjectsLoaded)}setDataViews(){this.setProjectsView(),this.setTasksView(),this.loaded=!0}setProjectsView(){this.projectViews=this.projects.map((t=>this.getViewFromProject(t)))}getViewFromProject(t){const e=Object.assign({},t),s=this.transactions.filter((t=>t.projectId===e.id));return this.processExpenses(s,e),this.processIncomes(s,e),e.profit=e.totalIncomes-e.totalExpenses,e.balance=e.budget+e.profit,e}processExpenses(t,e){const s=t.filter((t=>t.type===o.a.Expense));e.totalExpenses=s.length>0?s.map((t=>t.amount)).reduce(((t,e)=>t+e)):0}processIncomes(t,e){const s=t.filter((t=>t.type===o.a.Incoming));e.totalIncomes=s.length>0?s.map((t=>t.amount)).reduce(((t,e)=>t+e)):0}setTasksView(){this.tasksViews={total:this.tasks.length,pending:this.tasks.filter((t=>!t.done)).length}}}return t.\u0275fac=function(e){return new(e||t)(c.Hb(i.a))},t.\u0275cmp=c.Bb({type:t,selectors:[["ab-home"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["noDataYet",""],[4,"ngFor","ngForOf"],[3,"routerLink"],[4,"ngIf"]],template:function(t,e){if(1&t&&(c.cc(0,u,21,7,"section",0),c.cc(1,l,3,0,"ng-template",null,1,c.dc)),2&t){const t=c.Zb(2);c.Wb("ngIf",e.loaded)("ngIfElse",t)}},directives:[n.k,n.j,b.d],pipes:[n.e,n.d],styles:[""]}),t})()}];let f=(()=>{class t{}return t.\u0275mod=c.Fb({type:t}),t.\u0275inj=c.Eb({factory:function(e){return new(e||t)},imports:[[b.e.forChild(h)],b.e]}),t})(),g=(()=>{class t{}return t.\u0275mod=c.Fb({type:t}),t.\u0275inj=c.Eb({factory:function(e){return new(e||t)},imports:[[n.b,f]]}),t})()}}]);